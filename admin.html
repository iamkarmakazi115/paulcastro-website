<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Paul Castro</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="admin-page">
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Navigation Sidebar -->
    <nav class="nav-sidebar" id="navSidebar">
        <div class="nav-logo">
            <h1>Admin Panel</h1>
        </div>
        <ul class="nav-menu">
            <li class="nav-item active">
                <a href="#dashboard" class="nav-link" data-text="Dashboard" onclick="showSection('dashboard')">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </a>
            </li>
            <li class="nav-item">
                <a href="#users" class="nav-link" data-text="Users" onclick="showSection('users')">
                    <i class="fas fa-users"></i> Users
                </a>
            </li>
            <li class="nav-item">
                <a href="#rooms" class="nav-link" data-text="Rooms" onclick="showSection('rooms')">
                    <i class="fas fa-door-open"></i> Rooms
                </a>
            </li>
            <li class="nav-item">
                <a href="#blocked" class="nav-link" data-text="Blocked IPs" onclick="showSection('blocked')">
                    <i class="fas fa-ban"></i> Blocked IPs
                </a>
            </li>
            <li class="nav-item">
                <a href="#requests" class="nav-link" data-text="Access Requests" onclick="showSection('requests')">
                    <i class="fas fa-envelope-open"></i> Requests
                </a>
            </li>
            <li class="nav-item">
                <a href="#monitor" class="nav-link" data-text="Live Monitor" onclick="showSection('monitor')">
                    <i class="fas fa-eye"></i> Monitor
                </a>
            </li>
        </ul>
        <div class="back-home">
            <a href="index.html" class="nav-link" data-text="â† Exit Admin">
                <i class="fas fa-sign-out-alt"></i> Exit Admin
            </a>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Login Form (shown first) -->
        <div id="adminLogin" class="admin-login">
            <div class="login-container">
                <h2><i class="fas fa-shield-alt"></i> Admin Authentication</h2>
                <form id="adminLoginForm" onsubmit="handleAdminLogin(event)">
                    <div class="form-group">
                        <label for="adminUsername">Username</label>
                        <input type="text" id="adminUsername" required>
                    </div>
                    <div class="form-group">
                        <label for="adminPassword">Password</label>
                        <input type="password" id="adminPassword" required>
                    </div>
                    <button type="submit" class="admin-login-btn">
                        <i class="fas fa-lock"></i> Secure Login
                    </button>
                </form>
            </div>
        </div>

        <!-- Admin Panel (hidden until login) -->
        <div id="adminPanel" style="display: none;">
            <div class="content-wrapper">
                <header class="page-header">
                    <h1 class="page-title">System Administration</h1>
                    <div class="admin-info">
                        <span>Logged in as: <strong id="adminName">Admin</strong></span>
                        <button onclick="adminLogout()" class="logout-btn">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </header>
                
                <!-- Dashboard Section -->
                <section id="dashboardSection" class="admin-section">
                    <h2 class="admin-section-title">Dashboard Overview</h2>
                    <div class="stats-grid">
                        <div class="stat-box">
                            <i class="fas fa-users"></i>
                            <h3 id="totalUsers">0</h3>
                            <p>Total Users</p>
                        </div>
                        <div class="stat-box">
                            <i class="fas fa-door-open"></i>
                            <h3 id="activeRooms">0</h3>
                            <p>Active Rooms</p>
                        </div>
                        <div class="stat-box">
                            <i class="fas fa-ban"></i>
                            <h3 id="blockedIPs">0</h3>
                            <p>Blocked IPs</p>
                        </div>
                        <div class="stat-box">
                            <i class="fas fa-envelope"></i>
                            <h3 id="pendingRequests">0</h3>
                            <p>Pending Requests</p>
                        </div>
                    </div>
                    
                    <div class="recent-activity">
                        <h3>Recent Activity</h3>
                        <div id="activityLog" class="activity-log">
                            <!-- Activity items will be loaded dynamically -->
                        </div>
                    </div>
                </section>

                <!-- Users Management Section -->
                <section id="usersSection" class="admin-section" style="display: none;">
                    <h2 class="admin-section-title">User Management</h2>
                    <div class="admin-controls">
                        <input type="text" id="userSearch" placeholder="Search users..." class="search-input">
                        <button onclick="addUser()" class="add-btn">
                            <i class="fas fa-user-plus"></i> Add User
                        </button>
                    </div>
                    <div class="admin-panel">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Username</th>
                                    <th>Email</th>
                                    <th>Status</th>
                                    <th>Last Login</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                <!-- Users will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Rooms Management Section -->
                <section id="roomsSection" class="admin-section" style="display: none;">
                    <h2 class="admin-section-title">Room Management</h2>
                    <div class="admin-panel">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Room Name</th>
                                    <th>Code</th>
                                    <th>Host</th>
                                    <th>Users</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="roomsTableBody">
                                <!-- Rooms will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Blocked IPs Section -->
                <section id="blockedSection" class="admin-section" style="display: none;">
                    <h2 class="admin-section-title">Blocked IP Management</h2>
                    <div class="admin-controls">
                        <input type="text" id="ipInput" placeholder="IP Address to block..." class="search-input">
                        <input type="text" id="blockReason" placeholder="Reason..." class="search-input">
                        <button onclick="blockIP()" class="add-btn">
                            <i class="fas fa-ban"></i> Block IP
                        </button>
                    </div>
                    <div class="admin-panel">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>IP Address</th>
                                    <th>Reason</th>
                                    <th>Blocked By</th>
                                    <th>Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="blockedTableBody">
                                <!-- Blocked IPs will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Access Requests Section -->
                <section id="requestsSection" class="admin-section" style="display: none;">
                    <h2 class="admin-section-title">Access Requests</h2>
                    <div class="admin-panel">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Email</th>
                                    <th>Reason</th>
                                    <th>IP Address</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="requestsTableBody">
                                <!-- Requests will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Live Monitor Section -->
                <section id="monitorSection" class="admin-section" style="display: none;">
                    <h2 class="admin-section-title">Live Room Monitor</h2>
                    <div class="monitor-grid">
                        <div class="monitor-rooms">
                            <h3>Active Rooms</h3>
                            <div id="monitorRoomsList" class="monitor-list">
                                <!-- Active rooms for monitoring -->
                            </div>
                        </div>
                        <div class="monitor-view">
                            <h3>Room View: <span id="monitoringRoom">None</span></h3>
                            <div class="monitor-content">
                                <div class="monitor-video-grid" id="monitorVideoGrid">
                                    <!-- Video feeds will appear here -->
                                </div>
                                <div class="monitor-chat" id="monitorChat">
                                    <!-- Chat messages will appear here -->
                                </div>
                                <div class="monitor-controls">
                                    <button onclick="muteAllUsers()" class="action-btn">
                                        <i class="fas fa-microphone-slash"></i> Mute All
                                    </button>
                                    <button onclick="clearChat()" class="action-btn">
                                        <i class="fas fa-broom"></i> Clear Chat
                                    </button>
                                    <button onclick="closeRoom()" class="action-btn block">
                                        <i class="fas fa-times-circle"></i> Close Room
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/admin.js"></script>
</body>
</html>

<style>
/* Additional Admin Page Styles */
.admin-login {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: calc(100vh - 100px);
}

.login-container {
    background: rgba(42, 42, 42, 0.9);
    padding: 3rem;
    border-radius: 10px;
    border: 2px solid var(--primary-red);
    max-width: 400px;
    width: 100%;
}

.login-container h2 {
    color: var(--primary-red);
    text-align: center;
    margin-bottom: 2rem;
    font-family: 'Orbitron', monospace;
}

.form-group {
    margin-bottom: 1.5rem;
}

.form-group label {
    display: block;
    color: var(--text-light);
    margin-bottom: 0.5rem;
}

.form-group input {
    width: 100%;
    padding: 0.8rem;
    background: rgba(10, 10, 10, 0.8);
    border: 1px solid var(--secondary-grey);
    color: var(--text-light);
    border-radius: 5px;
    font-size: 1rem;
}

.admin-login-btn {
    width: 100%;
    padding: 1rem;
    background: linear-gradient(45deg, var(--primary-red), var(--secondary-grey));
    color: rgb(102, 102, 102);
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    font-size: 1.1rem;
    transition: all 0.3s ease;
}

.admin-login-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 5px 20px rgba(220, 20, 60, 0.4);
}

.admin-info {
    display: flex;
    align-items: center;
    gap: 2rem;
    color: var(--text-light);
}

.logout-btn {
    padding: 0.5rem 1rem;
    background: var(--primary-red);
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.logout-btn:hover {
    background: #B91C1C;
}

.admin-section {
    margin-bottom: 2rem;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 2rem;
    margin-bottom: 3rem;
}

.stat-box {
    background: rgba(42, 42, 42, 0.8);
    padding: 2rem;
    border-radius: 10px;
    text-align: center;
    border: 2px solid transparent;
    transition: all 0.3s ease;
}

.stat-box:hover {
    border-color: var(--primary-red);
    transform: translateY(-5px);
}

.stat-box i {
    font-size: 3rem;
    color: var(--primary-red);
    margin-bottom: 1rem;
}

.stat-box h3 {
    font-size: 2.5rem;
    color: var(--text-light);
    margin-bottom: 0.5rem;
}

.stat-box p {
    color: #888;
}

.recent-activity {
    background: rgba(95, 95, 95, 0.8);
    padding: 2rem;
    border-radius: 10px;
}

.recent-activity h3 {
    color: var(--primary-red);
    margin-bottom: 1rem;
}

.activity-log {
    max-height: 300px;
    overflow-y: auto;
}

.activity-item {
    padding: 1rem;
    border-bottom: 1px solid var(--secondary-grey);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.activity-item:last-child {
    border-bottom: none;
}

.activity-text {
    color: var(--text-light);
}

.activity-time {
    color: #888;
    font-size: 0.9rem;
}

.admin-controls {
    display: flex;
    gap: 1rem;
    margin-bottom: 2rem;
}

.search-input {
    flex: 1;
    padding: 0.8rem;
    background: rgba(42, 42, 42, 0.8);
    border: 1px solid var(--secondary-grey);
    color: var(--text-light);
    border-radius: 5px;
}

.add-btn {
    padding: 0.8rem 1.5rem;
    background: linear-gradient(45deg, var(--primary-red), var(--secondary-grey));
    color: rgb(110, 110, 110);
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s ease;
}

.add-btn:hover {
    transform: scale(1.05);
}

.monitor-grid {
    display: grid;
    grid-template-columns: 300px 1fr;
    gap: 2rem;
    height: calc(100vh - 350px);
}

.monitor-rooms {
    background: rgba(10, 10, 10, 0.9);
    border-radius: 10px;
    padding: 1rem;
}

.monitor-rooms h3 {
    color: var(--primary-red);
    margin-bottom: 1rem;
}

.monitor-list {
    max-height: calc(100vh - 450px);
    overflow-y: auto;
}

.monitor-room-item {
    background: rgba(42, 42, 42, 0.8);
    padding: 1rem;
    margin-bottom: 0.8rem;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.monitor-room-item:hover {
    background: rgba(220, 20, 60, 0.2);
}

.monitor-room-item.active {
    border: 2px solid var(--primary-red);
}

.monitor-view {
    background: rgba(42, 42, 42, 0.6);
    border-radius: 10px;
    padding: 1rem;
}

.monitor-view h3 {
    color: var(--text-light);
    margin-bottom: 1rem;
}

.monitor-view h3 span {
    color: var(--primary-red);
}

.monitor-content {
    height: calc(100% - 50px);
    display: flex;
    flex-direction: column;
}

.monitor-video-grid {
    flex: 1;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 1rem;
    overflow-y: auto;
}

.monitor-video-item {
    background: black;
    aspect-ratio: 16/9;
    border-radius: 5px;
    position: relative;
}

.monitor-video-item video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 5px;
}

.monitor-video-label {
    position: absolute;
    bottom: 5px;
    left: 5px;
    background: rgba(0, 0, 0, 0.7);
    color: rgb(115, 115, 115);
    padding: 0.2rem 0.5rem;
    border-radius: 3px;
    font-size: 0.8rem;
}

.monitor-chat {
    height: 150px;
    background: rgba(10, 10, 10, 0.8);
    padding: 1rem;
    overflow-y: auto;
    margin-bottom: 1rem;
    border-radius: 5px;
}

.monitor-controls {
    display: flex;
    gap: 1rem;
}

.monitor-controls .action-btn {
    flex: 1;
}

@media (max-width: 1024px) {
    .monitor-grid {
        grid-template-columns: 1fr;
    }
    
    .monitor-rooms {
        display: none;
    }
}

@media (max-width: 768px) {
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .admin-controls {
        flex-direction: column;
    }
    
    .admin-table {
        font-size: 0.9rem;
    }
    
    .admin-table th,
    .admin-table td {
        padding: 0.5rem;
    }
}
</style>